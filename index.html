<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bonjour Monde</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="site-header">
    <div class="site-header__bar">
      <div class="site-header__brand">MAES Studio</div>
      <nav class="site-header__nav" aria-label="Navigation principale">
        <a href="#intro">Introduction</a>
        <a href="#chart">Visualisation</a>
        <a href="#profiles">Profils</a>
      </nav>
      <a class="site-header__pill" href="#chart">Lancer la d√©mo</a>
    </div>
  </header>

  <section class="hero">
    <div class="hero__overlay"></div>
    <div class="hero__content">
      <p class="hero__eyebrow">Projet en construction</p>
      <h1 class="hero__title">Hello World</h1>
      <p class="hero__subtitle">Un premier pas vers un nouveau site web minimaliste, enrichi d'une exp√©rience plus fluide.</p>
      <div class="hero__actions">
        <a class="hero__cta" href="#intro">D√©couvrir</a>
        <a class="hero__ghost" href="#chart">Explorer les donn√©es</a>
      </div>
      <div class="hero__metrics" aria-label="Indicateurs cl√©s">
        <div class="metric-card">
          <span class="metric-card__label">Param√®tres ajustables</span>
          <span class="metric-card__value">5 sliders</span>
        </div>
        <div class="metric-card">
          <span class="metric-card__label">Solutions simul√©es</span>
          <span class="metric-card__value">26 points</span>
        </div>
        <div class="metric-card">
          <span class="metric-card__label">Profils d√©taill√©s</span>
          <span class="metric-card__value">3 courbes</span>
        </div>
      </div>
    </div>
  </section>

  <main id="intro" class="intro">
    <div class="intro__card">
      <h2>Bienvenue</h2>
      <p>Ce site simple affiche ¬´ Hello World ¬ª pour marquer le d√©but du projet. Vous pourrez √©toffer le contenu au fil du temps.</p>
      <div class="intro__grid" aria-label="Atouts de la d√©mo">
        <div class="intro__tile">
          <div class="intro__icon">‚ú®</div>
          <div>
            <div class="intro__tile-title">Design soign√©</div>
            <p class="intro__tile-text">Palette contrast√©e, coins arrondis et ombres douces pour un rendu premium.</p>
          </div>
        </div>
        <div class="intro__tile">
          <div class="intro__icon">üéõÔ∏è</div>
          <div>
            <div class="intro__tile-title">Contr√¥les guid√©s</div>
            <p class="intro__tile-text">Des sliders annot√©s et des axes clairs pour comprendre chaque r√©glage.</p>
          </div>
        </div>
        <div class="intro__tile">
          <div class="intro__icon">üìà</div>
          <div>
            <div class="intro__tile-title">Visualisation imm√©diate</div>
            <p class="intro__tile-text">Les points et profils se mettent √† jour d√®s que vous modifiez un param√®tre.</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <section id="chart" class="chart" aria-labelledby="chart-title">
    <div class="chart__card">
      <div class="chart__header">
        <p class="chart__eyebrow">Donn√©es fictives</p>
        <h2 id="chart-title">Explorer un mod√®le physique</h2>
        <p class="chart__description">Ajustez les param√®tres p1 √† p5 puis choisissez quelles grandeurs g1 √† g10 visualiser sur les axes.</p>
        <p class="chart__helper">Survolez le nuage pour comparer les grandeurs et ajustez les param√®tres pour observer des profils contrast√©s.</p>
      </div>
      <div class="chart__body">
        <div class="chart__figure" role="img" aria-label="Graphique en nuage de points"></div>
        <div class="chart__controls" aria-label="R√©glages du nuage de points">
          <div class="chart__control-group">
            <div class="chart__group-title">Param√®tres d'entr√©e</div>
            <div class="chart__slider-grid">
              <div class="chart__control">
                <div class="chart__control-row">
                  <label for="p1-slider">p1</label>
                  <input id="p1-slider" type="range" min="0" max="100" step="1" value="50">
                  <span id="p1-value" class="chart__pill">50</span>
                </div>
              </div>
              <div class="chart__control">
                <div class="chart__control-row">
                  <label for="p2-slider">p2</label>
                  <input id="p2-slider" type="range" min="0" max="100" step="1" value="40">
                  <span id="p2-value" class="chart__pill">40</span>
                </div>
              </div>
              <div class="chart__control">
                <div class="chart__control-row">
                  <label for="p3-slider">p3</label>
                  <input id="p3-slider" type="range" min="0" max="100" step="1" value="30">
                  <span id="p3-value" class="chart__pill">30</span>
                </div>
              </div>
              <div class="chart__control">
                <div class="chart__control-row">
                  <label for="p4-slider">p4</label>
                  <input id="p4-slider" type="range" min="0" max="100" step="1" value="60">
                  <span id="p4-value" class="chart__pill">60</span>
                </div>
              </div>
              <div class="chart__control">
                <div class="chart__control-row">
                  <label for="p5-slider">p5</label>
                  <input id="p5-slider" type="range" min="0" max="100" step="1" value="20">
                  <span id="p5-value" class="chart__pill">20</span>
                </div>
              </div>
            </div>
          </div>

          <div class="chart__control-group">
            <div class="chart__group-title">Axes du graphique</div>
            <div class="chart__axis-selectors">
              <label class="chart__select-label" for="x-axis-select">Axe X</label>
              <select id="x-axis-select" class="chart__select" aria-label="Choisir la grandeur pour l'axe X">
                <option value="g1">g1</option>
                <option value="g2">g2</option>
                <option value="g3">g3</option>
                <option value="g4">g4</option>
                <option value="g5">g5</option>
                <option value="g6">g6</option>
                <option value="g7">g7</option>
                <option value="g8">g8</option>
                <option value="g9">g9</option>
                <option value="g10">g10</option>
              </select>
              <label class="chart__select-label" for="y-axis-select">Axe Y</label>
              <select id="y-axis-select" class="chart__select" aria-label="Choisir la grandeur pour l'axe Y">
                <option value="g2">g2</option>
                <option value="g1">g1</option>
                <option value="g3">g3</option>
                <option value="g4">g4</option>
                <option value="g5">g5</option>
                <option value="g6">g6</option>
                <option value="g7">g7</option>
                <option value="g8">g8</option>
                <option value="g9">g9</option>
                <option value="g10">g10</option>
              </select>
            </div>
            <p class="chart__controls-note">Les solutions simul√©es sont recalcul√©es d√®s que vous bougez un slider ou changez d'axe.</p>
          </div>
        </div>
      </div>

      <div class="chart__insights" aria-live="polite">
        <div class="chart__insight">
          <div class="chart__insight-label">√ânergie simul√©e</div>
          <div id="insight-energy" class="chart__insight-value">‚Äî</div>
          <p class="chart__insight-hint">Moyenne pond√©r√©e p1/p2</p>
        </div>
        <div class="chart__insight">
          <div class="chart__insight-label">Balance thermique</div>
          <div id="insight-thermal" class="chart__insight-value">‚Äî</div>
          <p class="chart__insight-hint">Comparaison p3 ‚Üî p4</p>
        </div>
        <div class="chart__insight">
          <div class="chart__insight-label">Tol√©rance milieu</div>
          <div id="insight-tolerance" class="chart__insight-value">‚Äî</div>
          <p class="chart__insight-hint">Influence de p5</p>
        </div>
      </div>

      <div class="chart__profiles" aria-live="polite">
        <div class="chart__profiles-header">
          <div>
            <p class="chart__eyebrow chart__eyebrow--sub">Profils associ√©s</p>
            <h3 class="chart__profiles-title">Profils en fonction de x</h3>
            <p class="chart__profiles-description">Cliquez sur un point pour afficher les profils de pression P(x), densit√© œÅ(x) et temp√©rature T(x) qui lui sont associ√©s.</p>
          </div>
          <div id="profile-badge" class="chart__profiles-badge">Aucun point s√©lectionn√©</div>
        </div>
        <div id="profile-content" class="chart__profiles-grid">
          <p class="chart__profiles-placeholder">Cliquez sur un point pour afficher les courbes correspondantes.</p>
        </div>
      </div>

      <div class="chart__legend">
        <span class="chart__legend-dot"></span>
        <span>Chaque cercle repr√©sente une mesure simul√©e.</span>
      </div>
    </div>
  </section>

  <section id="profiles" class="footer">
    <p>Cr√©√© avec ‚ù§Ô∏è pour d√©marrer rapidement.</p>
  </section>

  <script>
    const chartContainer = document.querySelector('.chart__figure');
    const tooltip = document.createElement('div');
    tooltip.className = 'chart__tooltip';
    chartContainer.appendChild(tooltip);

    const profileContent = document.getElementById('profile-content');
    const profileBadge = document.getElementById('profile-badge');

    const sliders = [
      { id: 'p1', element: document.getElementById('p1-slider'), display: document.getElementById('p1-value') },
      { id: 'p2', element: document.getElementById('p2-slider'), display: document.getElementById('p2-value') },
      { id: 'p3', element: document.getElementById('p3-slider'), display: document.getElementById('p3-value') },
      { id: 'p4', element: document.getElementById('p4-slider'), display: document.getElementById('p4-value') },
      { id: 'p5', element: document.getElementById('p5-slider'), display: document.getElementById('p5-value') },
    ];
    const xAxisSelect = document.getElementById('x-axis-select');
    const yAxisSelect = document.getElementById('y-axis-select');
    const insightEnergy = document.getElementById('insight-energy');
    const insightThermal = document.getElementById('insight-thermal');
    const insightTolerance = document.getElementById('insight-tolerance');

    let currentSolutions = [];
    let selectedSolutionIndex = null;

    const width = chartContainer.clientWidth || 720;
    const height = 360;
    const margin = { top: 24, right: 24, bottom: 48, left: 48 };

    const svgNS = 'http://www.w3.org/2000/svg';
    const svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
    svg.setAttribute('role', 'presentation');

    const innerWidth = width - margin.left - margin.right;
    const innerHeight = height - margin.top - margin.bottom;

    const axes = document.createElementNS(svgNS, 'g');
    axes.setAttribute('stroke', 'rgba(226, 232, 240, 0.4)');
    axes.setAttribute('stroke-width', '1.5');
    axes.setAttribute('shape-rendering', 'crispEdges');

    const xAxis = document.createElementNS(svgNS, 'line');
    xAxis.setAttribute('x1', margin.left);
    xAxis.setAttribute('x2', margin.left + innerWidth);
    xAxis.setAttribute('y1', margin.top + innerHeight);
    xAxis.setAttribute('y2', margin.top + innerHeight);
    axes.appendChild(xAxis);

    const yAxis = document.createElementNS(svgNS, 'line');
    yAxis.setAttribute('x1', margin.left);
    yAxis.setAttribute('x2', margin.left);
    yAxis.setAttribute('y1', margin.top);
    yAxis.setAttribute('y2', margin.top + innerHeight);
    axes.appendChild(yAxis);

    const xTicksGroup = document.createElementNS(svgNS, 'g');
    const yTicksGroup = document.createElementNS(svgNS, 'g');
    const xAxisLabel = document.createElementNS(svgNS, 'text');
    const yAxisLabel = document.createElementNS(svgNS, 'text');

    xAxisLabel.setAttribute('fill', 'var(--muted)');
    xAxisLabel.setAttribute('font-size', '12');
    xAxisLabel.setAttribute('text-anchor', 'middle');
    xAxisLabel.setAttribute('x', margin.left + innerWidth / 2);
    xAxisLabel.setAttribute('y', margin.top + innerHeight + 36);

    yAxisLabel.setAttribute('fill', 'var(--muted)');
    yAxisLabel.setAttribute('font-size', '12');
    yAxisLabel.setAttribute('text-anchor', 'middle');
    yAxisLabel.setAttribute('transform', `translate(${margin.left - 36} ${margin.top + innerHeight / 2}) rotate(-90)`);

    axes.appendChild(xTicksGroup);
    axes.appendChild(yTicksGroup);
    axes.appendChild(xAxisLabel);
    axes.appendChild(yAxisLabel);

    svg.appendChild(axes);

    const pointsGroup = document.createElementNS(svgNS, 'g');
    svg.appendChild(pointsGroup);

    const defs = document.createElementNS(svgNS, 'defs');
    const gradient = document.createElementNS(svgNS, 'linearGradient');
    gradient.setAttribute('id', 'pointGradient');
    gradient.setAttribute('x1', '0%');
    gradient.setAttribute('y1', '0%');
    gradient.setAttribute('x2', '100%');
    gradient.setAttribute('y2', '100%');

    const stop1 = document.createElementNS(svgNS, 'stop');
    stop1.setAttribute('offset', '0%');
    stop1.setAttribute('stop-color', '#38bdf8');
    gradient.appendChild(stop1);

    const stop2 = document.createElementNS(svgNS, 'stop');
    stop2.setAttribute('offset', '100%');
    stop2.setAttribute('stop-color', '#6366f1');
    gradient.appendChild(stop2);

    defs.appendChild(gradient);
    svg.insertBefore(defs, svg.firstChild);

    chartContainer.appendChild(svg);

    const scaleX = (value, domain) => {
      const range = domain.max - domain.min || 1;
      return margin.left + (value - domain.min) / range * innerWidth;
    };

    const scaleY = (value, domain) => {
      const range = domain.max - domain.min || 1;
      return margin.top + innerHeight - (value - domain.min) / range * innerHeight;
    };

    function clamp(value, min, max) {
      return Math.min(Math.max(value, min), max);
    }

    function buildProfiles(base) {
      const sampleCount = 24;
      const xValues = Array.from({ length: sampleCount }, (_, i) => Number(((i / (sampleCount - 1)) * 10).toFixed(2)));

      const pressure = xValues.map((x) => {
        return clamp(85 + 0.5 * base.p1 - 0.3 * base.p3 + Math.sin(x / 1.8 + base.p2 / 60) * 9 + (Math.random() - 0.5) * 2, 40, 180);
      });

      const density = xValues.map((x) => {
        return clamp(0.9 + 0.012 * base.p2 + Math.cos(x / 2.4 + base.p5 / 35) * 0.25 + (Math.random() - 0.5) * 0.04, 0.6, 2.4);
      });

      const temperature = xValues.map((x) => {
        return clamp(260 + 0.75 * base.p4 + Math.sin((x + base.p3 / 6) / 2.8) * 14 + (Math.random() - 0.5) * 4, 230, 420);
      });

      return { x: xValues, pressure, density, temperature };
    }

    function buildSolutions(baseParams) {
      const solutions = [];
      const sampleCount = 26;

      for (let i = 0; i < sampleCount; i++) {
        const jittered = Object.fromEntries(
          Object.entries(baseParams).map(([key, base]) => [
            key,
            clamp(base + (Math.random() - 0.5) * 14, 0, 100)
          ])
        );

        const { p1, p2, p3, p4, p5 } = jittered;
        const noise = (span) => (Math.random() - 0.5) * span;

        const g1 = 0.6 * p1 + 0.4 * p2 + 5 * Math.sin(p3 / 18) + noise(8);
        const g2 = 1.05 * p2 + 0.25 * p3 + noise(10);
        const g3 = 0.5 * p3 + 0.8 * p4 + 12 * Math.cos(p1 / 30) + noise(9);
        const g4 = 0.9 * p4 + 0.2 * p1 + noise(7);
        const g5 = 0.7 * p5 + 0.35 * p2 + noise(7);
        const g6 = 0.8 * p1 + 0.5 * p3 - 0.3 * p5 + 40 + noise(12);
        const g7 = 0.6 * p2 + 0.6 * p5 + noise(10);
        const g8 = 0.4 * p3 + 0.9 * p4 + noise(8);
        const g9 = 0.5 * p1 + 0.5 * p4 + noise(6);
        const g10 = 0.7 * p2 + 0.2 * p3 + 0.4 * p5 + noise(10);

        solutions.push({
          ...jittered,
          profiles: buildProfiles(jittered),
          g1: clamp(g1, 0, 200),
          g2: clamp(g2, 0, 200),
          g3: clamp(g3, 0, 200),
          g4: clamp(g4, 0, 200),
          g5: clamp(g5, 0, 200),
          g6: clamp(g6, 0, 200),
          g7: clamp(g7, 0, 200),
          g8: clamp(g8, 0, 200),
          g9: clamp(g9, 0, 200),
          g10: clamp(g10, 0, 200)
        });
      }

      return solutions;
    }

    function getDomain(values) {
      const min = Math.min(...values);
      const max = Math.max(...values);
      const span = max - min;
      const padding = Math.max(span * 0.08, 4);
      return { min: min - padding, max: max + padding };
    }

    function formatTick(value) {
      return Math.abs(value) >= 100 ? value.toFixed(0) : value.toFixed(1);
    }

    function renderAxes(xDomain, yDomain, xLabel, yLabel) {
      xTicksGroup.innerHTML = '';
      yTicksGroup.innerHTML = '';

      const tickCount = 5;

      for (let i = 0; i <= tickCount; i++) {
        const xValue = xDomain.min + (xDomain.max - xDomain.min) * (i / tickCount);
        const xPos = scaleX(xValue, xDomain);
        const xTick = document.createElementNS(svgNS, 'line');
        xTick.setAttribute('x1', xPos);
        xTick.setAttribute('x2', xPos);
        xTick.setAttribute('y1', margin.top + innerHeight);
        xTick.setAttribute('y2', margin.top + innerHeight + 6);
        xTick.setAttribute('stroke', 'rgba(226, 232, 240, 0.4)');
        xTicksGroup.appendChild(xTick);

        const xTickLabel = document.createElementNS(svgNS, 'text');
        xTickLabel.textContent = formatTick(xValue);
        xTickLabel.setAttribute('x', xPos);
        xTickLabel.setAttribute('y', margin.top + innerHeight + 22);
        xTickLabel.setAttribute('fill', 'var(--muted)');
        xTickLabel.setAttribute('font-size', '12');
        xTickLabel.setAttribute('text-anchor', 'middle');
        xTicksGroup.appendChild(xTickLabel);
      }

      for (let i = 0; i <= tickCount; i++) {
        const yValue = yDomain.min + (yDomain.max - yDomain.min) * (i / tickCount);
        const yPos = scaleY(yValue, yDomain);
        const yTick = document.createElementNS(svgNS, 'line');
        yTick.setAttribute('x1', margin.left - 6);
        yTick.setAttribute('x2', margin.left);
        yTick.setAttribute('y1', yPos);
        yTick.setAttribute('y2', yPos);
        yTick.setAttribute('stroke', 'rgba(226, 232, 240, 0.4)');
        yTicksGroup.appendChild(yTick);

        const yTickLabel = document.createElementNS(svgNS, 'text');
        yTickLabel.textContent = formatTick(yValue);
        yTickLabel.setAttribute('x', margin.left - 12);
        yTickLabel.setAttribute('y', yPos + 4);
        yTickLabel.setAttribute('fill', 'var(--muted)');
        yTickLabel.setAttribute('font-size', '12');
        yTickLabel.setAttribute('text-anchor', 'end');
        yTicksGroup.appendChild(yTickLabel);
      }

      xAxisLabel.textContent = xLabel;
      yAxisLabel.textContent = yLabel;
    }

    function positionTooltip(event) {
      const bounds = chartContainer.getBoundingClientRect();
      const offsetX = event.clientX - bounds.left;
      const offsetY = event.clientY - bounds.top;
      tooltip.style.left = `${offsetX + 14}px`;
      tooltip.style.top = `${offsetY + 14}px`;
    }

    function renderPoints(points, xKey, yKey, xDomain, yDomain) {
      pointsGroup.innerHTML = '';
      points.forEach((point, index) => {
        const circle = document.createElementNS(svgNS, 'circle');
        circle.setAttribute('cx', scaleX(point[xKey], xDomain));
        circle.setAttribute('cy', scaleY(point[yKey], yDomain));
        circle.setAttribute('r', 7);
        circle.setAttribute('fill', 'url(#pointGradient)');
        circle.setAttribute('stroke', 'rgba(226, 232, 240, 0.2)');
        circle.setAttribute('stroke-width', '1.5');
        circle.dataset.solutionIndex = index;
        circle.setAttribute('tabindex', '0');

        if (index === selectedSolutionIndex) {
          circle.classList.add('chart__point--selected');
        }

        circle.addEventListener('pointerenter', (event) => {
          const hovered = currentSolutions[Number(circle.dataset.solutionIndex)];
          const rows = Object.entries(hovered)
            .filter(([key]) => key.startsWith('g'))
            .map(([key, value]) => `<li><span class="chart__tooltip-key">${key}</span><span class="chart__tooltip-value">${value.toFixed(1)}</span></li>`) 
            .join('');

          tooltip.innerHTML = `<div class="chart__tooltip-title">Point simul√©</div><ul class="chart__tooltip-list">${rows}</ul>`;
          tooltip.classList.add('chart__tooltip--visible');
          positionTooltip(event);
        });

        circle.addEventListener('pointermove', positionTooltip);

        circle.addEventListener('pointerleave', () => {
          tooltip.classList.remove('chart__tooltip--visible');
        });

        circle.addEventListener('blur', () => {
          tooltip.classList.remove('chart__tooltip--visible');
        });

        circle.addEventListener('click', () => {
          selectSolution(index);
        });

        circle.addEventListener('keydown', (event) => {
          if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault();
            selectSolution(index);
          }
        });

        pointsGroup.appendChild(circle);
      });
    }

    function sparklinePath(xValues, yValues, width = 240, height = 80, padding = 6) {
      const xMin = Math.min(...xValues);
      const xMax = Math.max(...xValues);
      const yMin = Math.min(...yValues);
      const yMax = Math.max(...yValues);
      const xRange = xMax - xMin || 1;
      const yRange = yMax - yMin || 1;

      const plotWidth = width - padding * 2;
      const plotHeight = height - padding * 2;

      return xValues
        .map((x, idx) => {
          const px = padding + ((x - xMin) / xRange) * plotWidth;
          const py = padding + plotHeight - ((yValues[idx] - yMin) / yRange) * plotHeight;
          return `${px},${py}`;
        })
        .join(' ');
    }

    function renderProfiles(solution, index) {
      const { profiles } = solution;
      profileBadge.textContent = `Point ${index + 1}`;

      const series = [
        { label: 'Pression P(x)', key: 'pressure', unit: 'kPa', color: '#38bdf8' },
        { label: 'Densit√© œÅ(x)', key: 'density', unit: 'kg/m¬≥', color: '#fbbf24' },
        { label: 'Temp√©rature T(x)', key: 'temperature', unit: 'K', color: '#a78bfa' },
      ];

      profileContent.innerHTML = '';

      series.forEach((serie) => {
        const values = profiles[serie.key];
        const path = sparklinePath(profiles.x, values);
        const min = Math.min(...values).toFixed(1);
        const max = Math.max(...values).toFixed(1);

        const card = document.createElement('div');
        card.className = 'chart__profile-card';
        card.innerHTML = `
          <div class="chart__profile-header">
            <span class="chart__profile-dot" style="background:${serie.color}"></span>
            <div>
              <div class="chart__profile-title">${serie.label}</div>
              <div class="chart__profile-meta">min ${min} ¬∑ max ${max} ${serie.unit}</div>
            </div>
          </div>
          <svg class="chart__sparkline" viewBox="0 0 240 80" role="img" aria-label="${serie.label}">
            <polyline fill="none" stroke="${serie.color}" stroke-width="2" points="${path}" />
          </svg>
        `;

        profileContent.appendChild(card);
      });
    }

    function selectSolution(index) {
      selectedSolutionIndex = index;
      renderProfiles(currentSolutions[index], index);

      Array.from(pointsGroup.children).forEach((circle, idx) => {
        circle.classList.toggle('chart__point--selected', idx === index);
      });
    }

    function resetProfiles() {
      selectedSolutionIndex = null;
      profileBadge.textContent = 'Aucun point s√©lectionn√©';
      profileContent.innerHTML = '<p class="chart__profiles-placeholder">Cliquez sur un point pour afficher les courbes correspondantes.</p>';
    }

    function updateInsights(baseParams) {
      const energy = Math.round(baseParams.p1 * 0.55 + baseParams.p2 * 0.45);
      const thermal = Math.round(100 - Math.abs(baseParams.p3 - baseParams.p4) * 0.9);
      const tolerance = Math.round(40 + baseParams.p5 * 0.6);

      insightEnergy.textContent = `${energy}%`;
      insightThermal.textContent = `${Math.max(0, Math.min(thermal, 100))}%`;
      insightTolerance.textContent = `${Math.max(0, Math.min(tolerance, 100))}%`;
    }

    function updateChart() {
      const baseParams = sliders.reduce((acc, slider) => {
        const value = Number(slider.element.value);
        slider.display.textContent = value.toFixed(0);
        acc[slider.id] = value;
        return acc;
      }, {});

      const xKey = xAxisSelect.value;
      const yKey = yAxisSelect.value;
      const solutions = buildSolutions(baseParams);
      currentSolutions = solutions;
      resetProfiles();
      updateInsights(baseParams);

      const xDomain = getDomain(solutions.map(solution => solution[xKey]));
      const yDomain = getDomain(solutions.map(solution => solution[yKey]));

      renderAxes(xDomain, yDomain, xKey.toUpperCase(), yKey.toUpperCase());
      renderPoints(solutions, xKey, yKey, xDomain, yDomain);
    }

    sliders.forEach(({ element }) => element.addEventListener('input', updateChart));
    xAxisSelect.addEventListener('change', updateChart);
    yAxisSelect.addEventListener('change', updateChart);

    updateChart();
  </script>
</body>
</html>
